<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title></title>
</head>
<body>
  <article id="app">
      <h1 class="tit">âœ¨ í›ì¸„ìœ—ëŒ“ Todo Todo Todo List âœ¨</h1>
      <ul class="box"></ul>

      <section class="add-section">
          <p class="add-tit">ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í• ì¼ì´ ì¶”ê°€ë©ë‹ˆë‹¤.</p>
          <p class="add-tit">ë¦¬ìŠ¤íŠ¸ë¥¼ í´ë¦­í•˜ë©´ í• ì¼ì´ ì‚­ì œë©ë‹ˆë‹¤.</p>
          <input type="text" id="txt">
          <button class="add-btn">ì¶”ê°€í•˜ê¸°</button>
          <button class="clear-button">ë‹¤í–ˆë‹¤!</button>
      </section>
  </article>

<script>

    const box = document.querySelector('.box');
    const text = document.querySelector('#txt');
    const addButton = document.querySelector('.add-btn');
    class Todo{
        constructor (text) {
            this.text = text;
        }
    }
      // todoListì— í•  ì¼ ë”í•˜ê³  ë¹¼ì£¼ëŠ” ê¸°ëŠ¥ êµ¬í˜„!
    memo = []
    let keyNumber = 0;

    class ToDoManager {
        constructor (list = []) {
            this.list = list;
        }
        addItem() {
            const todo = document.createElement('li');
            const date = document.createElement("span");
            // ë‚ ì§œêµ¬í•˜ëŠ” ì‹
            var today = new Date();
            let day = today.getDay();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            const WEEKDAY = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
            if(dd<10) {
                dd='0'+dd
            } 
            if(mm<10) {
                mm='0'+mm
            } 
            today = yyyy+'-' + mm+'-'+dd +'-'+ WEEKDAY[day];
            
            // frame ë§Œë“¤ì–´ì„œ textë‘ ë‚ ì§œ valueì— ë„£ì–´ì£¼ê¸°

            const frame = [[text.value, today]];
            
            
            // frame.push(text.value);
            // frame.push(today);
            

            // todo.innerText = new Todo(text.value).text;
            
            localStorage.setItem(keyNumber, frame[0]);
            viewer.sync();

            keyNumber++;
            text.value = '';
              // this.list.push(new Todo());
            //   console.log(localStorage.)
        }
        removeItem(item) {
            box.removeChild(item);
        }
        removeAll() {
            localStorage.clear();
            viewer.sync();
            keyNumber = 0;
        }
    }

    // localì—{1: "ë¹¨ë˜í•˜ê¸°", "2022-05-23-MON"}, {} ì´ëŸ°ì‹ìœ¼ë¡œ ë„£ì–´ì„œ splití•˜ì
    // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ë‘ ì—°ê²°í•´ì£¼ëŠ” class
    class ViewMaker {
        constructor () {
            };
        sync() {
            while (box.hasChildNodes()) {	// ë¶€ëª¨ë…¸ë“œê°€ ìì‹ì´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì•Œì•„ë‚¸ë‹¤
                box.removeChild(
                    box.firstChild
                );
            }
            for(let i = 0; i < localStorage.length; i++){
                const listContext = localStorage[i].split(",");

                const myList = document.createElement("li");
                const mySpan = document.createElement("span");
                
                myList.innerText = "ğŸ“Œ " + listContext[0];
                mySpan.innerText = listContext[1];
                
                box.appendChild(myList);
                myList.appendChild(mySpan);
                
            }
            
        }
    }
    
    const viewer = new ViewMaker();
    const manager = new ToDoManager();
    
    (function() {
            viewer.sync();
        })();

    clearBtn = document.querySelector(".clear-button");

    addButton.addEventListener('click', manager.addItem);
    clearBtn.addEventListener('click', manager.removeAll);

    box.addEventListener('click', e => {
        if (e.target.nodeName === 'LI') {
            
            manager.removeItem(e.target);
        }
    });

  </script>
</body>
</html>